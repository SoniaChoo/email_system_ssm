<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>邀请码登录</title>

    <!-- Bootstrap core CSS -->
    <link href="https://cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet">


    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <link href="./css/ie10.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="./css/signin.css" rel="stylesheet">

    <script src="./statics/jquery-3.5.1.js"></script>
    <script src="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>
</head>
<body>
<div>
    <div class="container">
        <form name="myForm" >
            <div class="form-group">
                <label>邀请码</label>
                <input name="invitationCode" type="text" class="form-control" id="invitationCode" placeholder="请输入您的邀请码"  required="true">
            </div>
            <button type="button" class="btn btn-default btn-block" data-toggle="modal" data-target="#myModal" style="background-color: #398439" onclick="return validate()" >提交</button>
        </form>
    </div>
</div>

<div id = "mydiv" border></div>
<!-- 按钮触发模态框 -->
<!--<button class="btn btn-primary btn-lg" data-toggle="modal" data-target="#myModal">-->
<!--    开始演示模态框-->
<!--</button>-->
<!-- 模态框（Modal） -->
<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                    &times;
                </button>
                <h4 class="modal-title" id="myModalLabel">
                    邀请码核对中,请稍等
                </h4>
            </div>
            <div class="modal-body">
                <div id = "myaccountInfo"></div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal" style="background-color: #398439">重新输入邀请码
                </button>
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal -->
</div>

<script>
    function validate() {
        if ($("#invitationCode").val()=="") {
            html = "<div>"+"邀请码不能为空"+"</div>";
            $("#myaccountInfo").html(html)
            return false;
        }
        $.ajax({
            url:"./invitation/checkInvitation",
            data:{"invitationCode":$("#invitationCode").val()},
            success:function (rdata) {
                var html = "";
                if(rdata.code===1){
                    console.log(rdata);
                    html = "<div>"+"邀请码不正确"+"</div>";
                    $("#myaccountInfo").html(html)
                }else if(rdata.code===2){
                    html = "<div>"+"邀请码已过期,请重新购买"+"</div>";
                    $("#myaccountInfo").html(html)
                }else{
                    $("#myModal").modal('hide');
                   /* html="<div id='myaccount'>" +"账号:" +rdata.data.accountEmail+"</div>"
                        +"<div id='mypassword'>" +"密码:" +rdata.data.accountPassword+"</div>";
                    $("#myaccountInfo").html(html)*/
                    document.location.href="./home.html?invitationCode="+$("#invitationCode").val()+"&captchaTo="+rdata.data.accountEmail+"&mypwd="+rdata.data.accountPassword+"&invitationDeadlinetime="+rdata.data.invitationDeadlinetime;
                }
            }
        })
    }
</script>


</body>
</html>